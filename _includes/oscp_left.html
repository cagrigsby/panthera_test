<section class="pan-layout-left"
  {% if site.left_side %}
  style="
  {% if site.left_side.background_image %}
  background-image: url({{ site.left_side.background_image }});
  {% endif %}
  {% if site.left_side.text_color %}
  color: {{ site.left_side.text_color }};
  {% endif %}
  "
  {% endif %}
>
  <section
    class="pan-layout-left__overlay"
    {% if site.left_side %}
    style="{% if site.left_side.background_color %}background-color: {{ site.left_side.background_color }} !important;{% endif %}"
    {% endif %}
  ></section>

  <div class="pan-layout-left__top">
    <!-- Existing top content here -->
  </div>
  
  <div class="pan-layout-left__middle">
    <h2>Table of Contents</h2>
    <ul class="pan-layout-left__menu">
      {% assign headers = page.content | split: '\n' %}
      {% for line in headers %}
        {% if line contains '#' %}
          {% assign header_level = line | split: ' ' | first | size | minus: 1 %}
          {% assign header_text = line | remove: '#' | strip %}
          {% if header_level < 6 %}
            <li class="header-level-{{ header_level }}">
              <a href="#{{ header_text | slugify }}">{{ header_text }}</a>
            </li>
          {% endif %}
        {% endif %}
      {% endfor %}
    </ul>
  </div>

  <div class="pan-layout-left__bottom">
    <div class="pan-layout-left__small">
      <span>GET IN TOUCH</span>
    </div>
    <div class="pan-layout-left__social">
      {% if site.social_icons %}
      <ul>
        {% for social in site.social_icons %}
        {% if social.icon %}
          <li>
            <a target="_blank" href="{{ social.link }}">
              {% if social.icon contains 'fa-' %}
                <i class="{{ social.icon }}"></i>
              {% else %}
                <img src="{{ social.icon }}" alt="{{ social.name }}" class="social-icon-img">
              {% endif %}
            </a>
          </li>
        {% endif %}
        {% endfor %}
      </ul>
      {% endif %}
    </div>
  </div>

  <div
    class="pan-layout-left__close"
    {% if site.left_side %}
    style="{% if site.left_side.close_button_color %}color: {{ site.left_side.close_button_color }} !important;{% endif %}"
    {% endif %}
  >
    <i class="fa fa-fw fa-times"></i>
  </div>
</section>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    var headers = document.querySelectorAll('.pan-layout-left__menu a');
    headers.forEach(function(header) {
      header.addEventListener('click', function(e) {
        e.preventDefault();
        var targetId = header.getAttribute('href').substring(1);
        var targetElement = document.getElementById(targetId);
        if (targetElement) {
          targetElement.scrollIntoView({ behavior: 'smooth' });
        }
      });
    });
  });
</script>
